{% extends "base.html" %}

{% block title %} User {% endblock %}

{% block content %}


<section class="breadcumb-area bg-img d-flex align-items-center justify-content-center auth-hero"
         style="background-image: url('{{ url_for('static', filename='img/bg-img/bg-1.jpg') }}');">
    <div class="bradcumbContent auth-panel">
        <div class="form-group">
                <div class="card-header bg-info text-white">
                    <h4 class="mb-0">Mi Perfil</h4>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <strong>ID:</strong>
                        <span id="usuario-id">...</span>
                    </div>
                    <div class="mb-3">
                        <strong>Nombre:</strong>
                        <span id="usuario-nombre">...</span>
                    </div>
                    <div class="mb-3">
                        <strong>Email:</strong>
                        <span id="usuario-email">...</span>
                    </div>                                                  
                </div>
        </div>
        
        <div class="form-group mt-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Mis Reservas</h5>
                </div>
                <div class="card-body">
                    <div id="reservas-container">
                        <p>reservas...</p>
                    </div>
                </div>
        </div>

    </div>
</section>
{% endblock %}
{% block extra_js %}
<script>
    function obtenerIdDeUsuario() {
        // Cambiar luego 
        // Obtener id por login    
        return {{ usuario.id | tojson }};
    }

    async function cargarUsuario() {
        const userId = obtenerIdDeUsuario();
        
        try {
            const url = "{{ url_for('api_usuario', user_id=0) }}".replace('0', userId);
            const res = await fetch(url);
            const usuario = await res.json();

            document.getElementById('usuario-id').textContent = usuario.id;
            document.getElementById('usuario-nombre').textContent = usuario.nombre;
            document.getElementById('usuario-email').textContent = usuario.email;
            
        } catch (error) {
            document.getElementById('usuario-id').textContent = 'Error';
            document.getElementById('usuario-nombre').textContent = 'Error al cargar datos';
            document.getElementById('usuario-email').textContent = error.message;
        }
    }

    document.addEventListener('DOMContentLoaded', cargarUsuario);
</script>
{% endblock %}